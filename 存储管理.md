## 概述

### 存储架构体系
1. 寄存器
2. 高速缓存
3. 主存储器
4. 外存

### 程序的转化过程

![程序的转化过程]

### 逻辑地址与物理地址

- 逻辑地址（相对地址，虚拟地址）：用户程序经过编译、汇编后形成目标代码，目标代码通常采用相对地址的形式，其首地址为0，其余地址都相对于首地址而编址
- 物理地址（绝对地址，实地址）：内存中储存单元的地址，可直接寻址

### 链接过程

将编译后的目标模块和库函数链接成一个完整的可执行程序，形成一个完整的装入模块（可执行程序）

程序链接的三种方式：
- 静态链接
- 装入时动态链接
- 运行时动态链接

### 装入过程

当程序被装入内存时，程序的逻辑地址被转化成内存的物理地址，这一过程被称为地址重定位

#### 绝对装入(absolute loading)

程序的装载地址（物理地址）是在编译链接的时候直接生成的。程序的逻辑地址与物理地址一致

#### 可重定位装入(relocatable loading)

- 静态重定位：允许程序装入内存中的任意位置，因此地址的重定位是在装入时完成的，且只进行一次，在程序的执行期间地址将不再发生变化，因此也称为静态重定位
- 运行时重定位/动态重定位：程序在装入内存时，不修改程序的逻辑地址值，程序在访问物理内存之前，再实时地将逻辑地址转换成物理地址

## 存储管理方案

### 连续分配方式

要求程序必须被连续的存储在一段内存区域之内

- 单一连续分区管理：内存一次允许装入一个用户程序，程序独占整个用户区
- 固定分区管理：先分区再分配
- 动态分区管理（可变分区）：预先不划分内存，当作业需要装载时系统从内存中分出一块，其大小等于该作业的大小，然后将剩下的部分再作为空白块给下一次分配使用

#### 分区分配算法

|     算法     |                             思想                             |       空闲分区       |      优点      |                         缺点                         |
| :----------: | :----------------------------------------------------------: | :------------------: | :------------: | :--------------------------------------------------: |
| 最先适应算法 |             从前往后找到第一个满足要求的空闲分区             |     地址递增排序     |   简单，快速   |               产生大量无法利用的小碎片               |
| 邻近适应算法 | 从上次分配的空闲分区开始找，直到找到第一个满足要求的空闲分区 | 地址递增排序（循环） |   简单，快速   |               产生大量无法利用的小碎片               |
| 最佳适应算法 |           从所有满足要求的空闲分区中找到最小的一个           |     容量递增排序     | 大分区得以保留 |   产生小碎片。开销大，回收分区要重新对空闲分区排队   |
| 最坏适应算法 |           从所有满足要求的空闲分区中找到最大的一个           |     容量递减排序     |   减少小碎片   | 大分区不能保留。开销大，回收分区要重新对空闲分区排队 |

#### 解决碎片问题的策略——紧凑

移动所有被分配的分区，使之成为一个连续区域，而留下一个较大的空白区

#### 连续分配方式的局限

作业存储时必须连续存放。这样当一个作业大于当前最大的空闲分区容量时，即使主存中有空闲区域也不能够利用，从而降低了存储空间利用率

### 非连续分配方式

将程序分为若干块，分别放在不同的空闲区中，从而使得存储空间的利用率得到提升。

#### 页式存储管理技术

把作业的虚拟地址空间划分为若干个长度相等的页(pages)，也可以成为虚页。主存页划分为若干个与虚页长度相等的页框(page frame)，也称为页面或实页

#### 页面变换表(Page Table)

也叫页表，是一种特殊的数据结构，用于记录虚页与实页的对应关系

[程序的转化过程]: pictures\程序的转化过程.png